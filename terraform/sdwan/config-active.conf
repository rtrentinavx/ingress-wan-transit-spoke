Content-Type: multipart/mixed; boundary="==AZURE=="
MIME-Version: 1.0

--==AZURE==
Content-Type: text/x-shellscript; charset="us-ascii"
MIME-Version: 1.0


config system interface
    edit port1
    set alias hamgmt
    set mode static
    set ip ${port1_ip} ${port1_mask}
    set allowaccess ping https ssh fgfm
next
    edit port2
    set alias untrust
    set mode static
    set ip ${port2_ip} ${port2_mask}
    set allowaccess ping https ssh fgfm
next
    edit port3
    set alias trust
    set mode static
    set ip ${port3_ip} ${port3_mask}
    set allowaccess ping https ssh fgfm
next
end

config router static
    edit 1
        set device port2
        set gateway ${defaultgwy}
    next
    edit 2
        set dst ${transit_gateway_prefix} ${transit_gateway_lenght}
        set gateway ${rfc1918gwy}
        set device "port3"
    next
end

config router bgp
    set as ${forti_as_num}
    set router-id ${forti_router_id}
    set ebgp-multipath enable
    set graceful-restart enable
    config neighbor
        edit ${transit_gateway}
        set ebgp-enforce-multihop enable
        set ebgp-multihop-ttl 16
        set remote-as ${transit_gateway_as}
    next
        edit ${transit_gateway_ha}
        set ebgp-enforce-multihop enable
        set ebgp-multihop-ttl 16
        set remote-as ${transit_gateway_as}
    next
    end
    config redistribute "connected"
    set status enable
    end
end 

%{ if type == "byol" }
--==AZURE==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="license"

${file(license_file)}

%{ endif }
--==AZURE==--
